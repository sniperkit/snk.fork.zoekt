FROM alpine:3.7

# user based
ARG PROG_PREFIX_PATH=${PROG_PREFIX_PATH:-"zkt"}
ARG PROG_BASENAME_PREFIX=${PROG_BASENAME_PREFIX:-"zoekt"}
ARG PROG_BASENAME=${PROG_BASENAME:-"webserver"}
ARG PROG_BASENAME_SUFFIX=${PROG_BASENAME_SUFFIX:-"linux"}

# dynamic
ARG PROG_PATH_LOCAL=${PROG_PATH_LOCAL:-"./${PROG_BASENAME_PREFIX}-${PROG_BASENAME}-${PROG_BASENAME_SUFFIX}"}
ARG PROG_PATH_CONTAINER=${PROG_PATH_CONTAINER:-"/${PROG_PREFIX_PATH}/${PROG_BASENAME_PREFIX}-${PROG_BASENAME}"}
ARG PROG_PATH_PREFIX=${PROG_PATH_PREFIX:-"/${PROG_PREFIX_PATH}"}

# container deps
RUN apk update \
	&& apk add --no-cache --no-progress ca-certificates \
	&& rm -rf /var/cache/apk/* \
	&& mkdir -p ${PROG_PATH_PREFIX}

# container binary
ADD ${PROG_PATH_LOCAL} ${PROG_PATH_CONTAINER}

# container configuration
WORKDIR ${PROG_PATH_PREFIX}
EXPOSE 8000
ENTRYPOINT ${PROG_PATH_CONTAINER}
# CMD [""]